---
import SearchModal from './SearchModal.astro';
---
<header class="sticky top-0 z-[1000] border-b border-white/10 bg-brand-bg/95 backdrop-blur-xl transition-all duration-300" id="main-header">
	<div class="mx-auto flex h-16 max-w-6xl items-center justify-between px-4">
		<a href="/" class="flex items-center gap-3 font-extrabold tracking-tight text-white transition hover:opacity-80" onclick="if(window.location.pathname === '/' || window.location.pathname === '') { window.scrollTo({top:0,behavior:'smooth'}); return false; }">
			<img src="/logo.png" alt="GoPropReels logo" class="h-10 w-10 rounded-xl" />
			<span class="text-lg">GoProp<span class="text-brand-accent">Reels</span></span>
		</a>
		<div class="flex items-center gap-3">
            {/* Desktop Nav */}
            <div class="hidden md:flex items-center gap-3">
                {/* Propfirm Dropdown */}
                <div class="relative group">
                    <button class="flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/10">
                        <i class="fa-solid fa-building text-brand-accent"></i>
                        <span>Propfirm</span>
                        <i class="fa-solid fa-chevron-down text-[10px] opacity-50 group-hover:rotate-180 transition-transform"></i>
                    </button>
                    <div class="absolute top-full left-0 w-48 scale-95 opacity-0 pointer-events-none group-hover:scale-100 group-hover:opacity-100 group-hover:pointer-events-auto transition-all duration-200 z-[1100]">
                        <div class="pt-2"> {/* Invisible bridge and spacing */}
                            <div class="rounded-2xl border border-white/10 bg-brand-bg/95 backdrop-blur-xl p-2 shadow-2xl">
                            <a href="/forex" class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition text-sm text-white/80 hover:text-white">
                                <i class="fa-solid fa-chart-line text-brand-accent w-5"></i>
                                Forex
                            </a>
                            <a href="/futures" class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition text-sm text-white/80 hover:text-white">
                                <i class="fa-solid fa-arrow-trend-up text-brand-accent w-5"></i>
                                Futures
                            </a>
                            <a href="/crypto" class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 transition text-sm text-white/80 hover:text-white">
                                <i class="fa-solid fa-bitcoin-sign text-brand-accent w-5"></i>
                                Crypto
                            </a>
                        </div>
                    </div>
                </div>
            </div>

                <a
                    href="/coupons"
                    class="relative flex items-center gap-2 rounded-full bg-brand-accent px-5 py-2 text-sm font-black text-white shadow-[0_0_20px_rgba(255,45,85,0.4)] transition hover:scale-105 hover:shadow-[0_0_30px_rgba(255,45,85,0.6)] active:scale-95"
                >
                    <i class="fa-solid fa-tag"></i>
                    <span>Coupons</span>
                    <span class="absolute -top-1 -right-1 h-2.5 w-2.5 rounded-full bg-green-400 animate-ping"></span>
                    <span class="absolute -top-1 -right-1 h-2.5 w-2.5 rounded-full bg-green-400"></span>
                </a>
                
                <a
                    href="/news"
                    class="flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/10"
                >
                    <i class="fa-solid fa-newspaper text-brand-accent"></i>
                    <span>News</span>
                </a>
                <a
                    href="/blog"
                    class="flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/10"
                >
                    <i class="fa-solid fa-newspaper text-brand-accent"></i>
                    <span>Blog</span>
                </a>
            </div>
            
            {/* Search Button (Desktop) */}
            <button
                id="search-btn-desktop"
                class="hidden items-center justify-center w-10 h-10 rounded-full border border-white/10 bg-white/5 text-white transition hover:bg-white/10 md:flex"
                aria-label="Search"
            >
                <i class="fa-solid fa-magnifying-glass text-brand-accent"></i>
            </button>

            {/* Search Button (Mobile) */}
             <button
                id="search-btn-mobile"
                class="flex items-center justify-center w-10 h-10 rounded-xl bg-white/5 border border-white/10 text-white md:hidden"
                aria-label="Search"
            >
                <i class="fa-solid fa-magnifying-glass text-brand-accent"></i>
            </button>

            {/* Mobile Menu Button */}
            <button id="mobile-menu-btn" class="flex items-center justify-center w-10 h-10 rounded-xl bg-white/5 border border-white/10 text-white md:hidden">
                <i class="fa-solid fa-bars text-xl" id="menu-icon"></i>
            </button>
		</div>
	</div>
</header>

    {/* Mobile Menu Overlay (Slides down from below header) */}
    <div id="mobile-menu" class="fixed top-16 left-0 right-0 bottom-0 z-[1001] bg-[#020617] transform translate-x-full transition-transform duration-300 md:hidden flex flex-col p-6 gap-4 border-t border-white/10 overflow-y-auto">
        
        <a href="/coupons" class="flex items-center gap-4 text-xl font-black text-white p-4 rounded-2xl bg-brand-accent/20 border-2 border-brand-accent/40 shadow-[0_0_20px_rgba(255,45,85,0.2)]">
            <div class="w-10 h-10 rounded-full bg-brand-accent flex items-center justify-center text-white">
                <i class="fa-solid fa-tag"></i>
            </div>
            ðŸ”¥ Active Coupons
        </a>
        <a href="/forex" class="flex items-center gap-4 text-xl font-bold text-white p-4 rounded-2xl bg-white/5 border border-white/10">
            <div class="w-10 h-10 rounded-full bg-brand-accent/20 flex items-center justify-center text-brand-accent">
                <i class="fa-solid fa-chart-line"></i>
            </div>
            Forex Coupons
        </a>
        <a href="/futures" class="flex items-center gap-4 text-xl font-bold text-white p-4 rounded-2xl bg-white/5 border border-white/10">
            <div class="w-10 h-10 rounded-full bg-brand-accent/20 flex items-center justify-center text-brand-accent">
                <i class="fa-solid fa-arrow-trend-up"></i>
            </div>
            Futures Coupons
        </a>
        <a href="/crypto" class="flex items-center gap-4 text-xl font-bold text-white p-4 rounded-2xl bg-white/5 border border-white/10">
            <div class="w-10 h-10 rounded-full bg-brand-accent/20 flex items-center justify-center text-brand-accent">
                <i class="fa-solid fa-bitcoin-sign"></i>
            </div>
            Crypto Coupons
        </a>
        <a href="/news" class="flex items-center gap-4 text-xl font-bold text-white p-4 rounded-2xl bg-white/5 border border-white/10">
            <div class="w-10 h-10 rounded-full bg-brand-accent/20 flex items-center justify-center text-brand-accent">
                <i class="fa-solid fa-newspaper"></i>
            </div>
            Latest News
        </a>
        <a href="/blog" class="flex items-center gap-4 text-xl font-bold text-white p-4 rounded-2xl bg-white/5 border border-white/10">
            <div class="w-10 h-10 rounded-full bg-brand-accent/20 flex items-center justify-center text-brand-accent">
                <i class="fa-solid fa-newspaper"></i>
            </div>
            Trading Blog
        </a>
    </div>

    <script>
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const menuIcon = document.getElementById('menu-icon');
        const mobileMenu = document.getElementById('mobile-menu');
        const searchBtnDesktop = document.getElementById('search-btn-desktop');
        const searchBtnMobile = document.getElementById('search-btn-mobile');

        function toggleMenu() {
            const isClosed = mobileMenu.classList.contains('translate-x-full');
            
            if (isClosed) {
                mobileMenu.classList.remove('translate-x-full');
                menuIcon.classList.remove('fa-bars');
                menuIcon.classList.add('fa-xmark');
                document.body.classList.add('overflow-hidden');
            } else {
                mobileMenu.classList.add('translate-x-full');
                menuIcon.classList.remove('fa-xmark');
                menuIcon.classList.add('fa-bars');
                document.body.classList.remove('overflow-hidden');
            }
        }

        mobileMenuBtn?.addEventListener('click', toggleMenu);
        
        // Search Buttons
        searchBtnDesktop?.addEventListener('click', () => window.openSearch());
        searchBtnMobile?.addEventListener('click', () => {
            if (!mobileMenu.classList.contains('translate-x-full')) {
                toggleMenu(); // Close mobile menu ONLY if it is open
            }
            window.openSearch();
        });
        
        // Close menu when clicking a link
        mobileMenu?.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', toggleMenu);
        });
    </script>
	<slot />
    <SearchModal />
